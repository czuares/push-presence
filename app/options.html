<!doctype html>
<html ng-app="pushPresenceApp" ng-csp>

<head>
  <meta charset="utf-8">
  <title>PushPresence</title>
  <!-- build:css styles/vendor.css -->
  <!-- bower:css -->
  <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css" />
  <link rel="stylesheet" href="bower_components/bootstrap-switch/dist/css/bootstrap3/bootstrap-switch.css" />
  <!-- endbower -->
  <!-- endbuild -->
  <!-- build:css styles/main.css -->
  <link rel="stylesheet" href="styles/main.css">
  <!-- endbuild -->
</head>

<body ng-cloak ng-controller="OptionsCtrl">
  <!-- <div>
    {{ config | json }}
    <hr> {{ model | json }}
  </div> -->
  <div class="page-header">
    <div class="row">
      <div class="col-md-8">
        <h1>PushPresence
          <small>PushBullet User Presence Extension</small>
        </h1>
      </div>
      <div class="col-md-4">
        <label>Enabled:
          <bs-switch ng-model="model.globalEnabled" type="checkbox"></bs-switch>
        </label>
        <span class="alert alert-warning" ng-if="!model.globalEnabled">
          Event monitoring is currently off. While monitoring is off, no pushes will be sent to any devices. Change the switch on the left to turn this back on.
        </span>
        <span class="alert alert-info" ng-if="model.globalEnabled">
          Event monitoring is on. Pushes will be sent to subscribed devices during the specified schedules.
        </span>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col-md-5 col-md-offset-7">
        <accordion>
          <accordion-group>
            <accordion-heading>
              PushBullet Configuration <i class="pull-right glyphicon glyphicon-cog"></i>
            </accordion-heading>
            <div>
              Click <a href="https://www.pushbullet.com/account" target="_blank">here</a> to get an access token
            </div>
            <div ng-class="{'has-error' : !(ApiKeySet()), 'has-success' : (ApiKeySet()) }">
              <div class="input-group">
                <input type="text" class="form-control" aria-label="API Token" placeholder="API Token" ng-change="SetToken()" ng-disabled="ApiKeySet()" ng-model="config.pushBulletApiToken" />
                <span class="input-group-btn">
                  <button class="btn btn-danger" type="button" ng-click="RevokeApiToken()" ng-disabled="!(ApiKeySet())">Unregister</button>
                </span>
              </div>
              <div class="alert alert-danger" ng-if="!(ApiKeySet())">
                API Token is required
              </div>
            </div>
            <button class="btn btn-default" ng-disabled="!online || !ApiKeySet()" ng-click="RefreshDevices()">Refresh Devices</button>
          </accordion-group>
        </accordion>
      </div>
    </div>
    <accordion class="subscriptions">
      <accordion-group ng-repeat="s in model.subscriptions | orderBy:['-enabled','device.name']">
        <accordion-heading>
          <span ng-class="{'disabled' : !s.enabled, 'text-success': s.enabled }">
            <i class="glyphicon glyphicon-{{ GetDeviceIcon(s) }}"></i> {{ GetDeviceName(s) }}
          </span>
        </accordion-heading>
        <app-subscription data="s"></app-subscription>
      </accordion-group>
    </accordion>
    <span ng-bind="saveStatus"></span>
  </div>
  <!-- build:js scripts/vendor.js -->
  <!-- bower:js -->
  <script src="bower_components/jquery/dist/jquery.js"></script>
  <script src="bower_components/underscore/underscore.js"></script>
  <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
  <script src="bower_components/angular/angular.js"></script>
  <script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
  <script src="bower_components/bootstrap-switch/dist/js/bootstrap-switch.js"></script>
  <script src="bower_components/angular-bootstrap-switch/dist/angular-bootstrap-switch.js"></script>
  <!-- endbower -->
  <!-- endbuild -->
  <!-- build:js scripts/options.js -->
  <script src="scripts/pushbullet.js"></script>
  <script src="scripts/datamodel.js"></script>
  <script src="scripts/angular/pushPresenceApp.js"></script>
  <script src="scripts/options.js"></script>
  <!-- endbuild -->
</body>

</html>
